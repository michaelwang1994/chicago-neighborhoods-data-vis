<!DOCTYPE html>
<meta charset="utf-8">
<title>Non-Contiguous Cartogram</title>
<style>

.community-area {
  fill: white;
  stroke: gray;
  stroke-width: 1;
}

.tooltip {
    font-family: 'Courier New', Courier, monospace;
    position: absolute;
    z-index: 10;
    visibility: hidden;
    background-color: white;
    text-align: center;
    padding: 4px;
    border-radius: 4px;
    color: black;
}

</style>
<body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/topojson.v2.min.js"></script>
<script>

var width = 1200;
var height = 700;

d3.json("data/boundaries-with-census-data.json", function(error, us) {
  if (error) throw error;
  
  var center = d3.geoCentroid(topojson.feature(us, us.objects.boundaries));
  var projection = d3.geoMercator().center(center).translate([width / 4, height / 2]).scale(50000);
  var path = d3.geoPath().projection(projection);

  var tooltip = d3.select("body")
    .append("div")
    .attr('class', 'tooltip');

  var colors = d3.scaleLinear()
    .domain([-.5, 0, .5])
    .range(["green", "lightgray", "red"]);

  var svg = d3.select("body")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

  svg.selectAll('.community-area')
		.data(topojson.feature(us, us.objects.boundaries).features)
		.enter()
		.append('path')
		.attr('class', 'community-area')
		.attr('d', path)
		.on('mouseover', function(d){
			return tooltip.style("visibility", "visible").text(
        'community name = ' + d.properties.pri_neigh)
		})
    .on("mousemove", function(d) {
      var hardship_index = d.properties.census_data.hardship_index;
      var color_to_return = (hardship_index - 50) / 100.0;
      
      d3.select(this)
        .style("fill", colors([color_to_return]))
      
      return tooltip.style("top", (event.pageY - 30) + "px")
        .style("left", event.pageX + "px")
    })
    .on("mouseout", function(d) {
      var hardship_index = d.properties.census_data.hardship_index;
      var color_to_return = (hardship_index - 50) / 150.0;
      
      d3.select(this)
        .style("fill", colors([color_to_return]))
    })
  });

</script>